IntraMine Main
==============

IntraMine's Main service ("Main") is at heart a round-robin redirector. It launches and shuts down other IntraMine services, redirects requests to them when requests come in directly or from another service that can't handle the request, and if there are several running instances of a service it passes requests to them in turn.

Main is not quite a "dumb pipe" though. In addition it:
 - serves as a hub for communications between IntraMine services: services can send messages to another specific service, to all services with a specific Page name, to all with a specific Short name, to Page or Background services, or to all services. For more details see intramine_main.pl#BroadcastSignal().
 - helps deliver Server-Sent Events, used when web pages need to talk to each other. For example, a running instance of the ToDo page will send an SSE whenever its contents change, and all other open views of the ToDo page will immediately update to match. See SSE.txt for more.
 - helps coordinate planned maintenance outages, as happens for example when a Linker service decides it needs to go away for a couple of minutes to rebuild its in-memory hash of file names and full paths in response to a folder rename: when such a signal is received, Main will instruct all running Linker servers to carry out the maintenance one at a time, so at least one Linker will be available at all times. For more, see intramine_main.pl#HandleMaintenanceSignal(), intramine_linker.pl#IndexChangedFiles() and intramine_linker.pl#HandleBroadcastRequest().

There's more about interacting with Main in "Writing your own IntraMine server.txt".

TABLE API
Action                     	URI						Details
Maintenance start			/?signal=knownMaintenanceSignal	intramine_main.pl#BroadcastSignal()
Maintenance done			/?signal=backinservice	intramine_main.pl#BroadcastSignal()
Explicit redirect request			/?req=redirect	intramine_main.pl#RedirectToCorrectedPort()
Implicit redirect request	/shortName/?request details	intramine_main.pl#ResultPage()
Send signal					/?signal=signalName		intramine_main.pl#BroadcastSignal()
Server status				/?req=filestatus	intramine_main.pl#ServerStatus()
Add one server				/?req=add_one_specific_server	intramine_main.pl#AddOneServer()
Start stop restart server	/?req=[one of 'start_one_specific_server', 'stop_one_specific_server', 'restart_one_specific_server']	intramine_main.pl#StartOneServer() etc
Open file		known file extension (.gif, .css etc), request not otherwise handled	intramine_main.pl#ResultPage()
Identify				/?req=ruthere	intramine_main.pl#RUThere()
Run tests at startup	-t on cmd line	intramine_main.pl##RunAllTests
Stop						GET /?EXITEXITEXIT=1 HTTP/1.1	intramine_main.pl#HandleEstablishedConnection
---
contents.txt
---
